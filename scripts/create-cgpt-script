#!/bin/bash

# Function to display usage information
usage() {
    echo "Usage: $0 <script_name> <description>"
    echo "Example: $0 git-auto-commit 'a program to automatically format a git commit from what is currently staged'"
    exit 1
}

# Check if we have the correct number of arguments
if [ $# -lt 2 ]; then
    usage
fi

# Assign arguments to variables
script_name="$1"
shift
description="$@"

# Create the prompt for cgpt
prompt="Create a bash script named '$script_name' that $description. The script should be well-commented, efficient, and follow best practices. If the script could benefit from using cgpt, include the following usage information:

<cgpt-usage>
$(cgpt -h 2>&1)
</cgpt-usage>

Output only the bash script content, starting with a shebang line and including appropriate comments."

# Use cgpt to generate the script
echo "$prompt" | cgpt -s "You are an expert bash programmer and AI assistant. Your task is to create high-quality, well-documented bash scripts based on the given descriptions. Ensure the scripts are efficient, follow best practices, and include error handling where appropriate." -m "claude-3-5-sonnet-20240620" -t 2000 -T 0.7 > "$script_name"

# Make the generated script executable
chmod +x "$script_name"

echo "Script '$script_name' has been created and made executable."